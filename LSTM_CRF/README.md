# LSTM-CRF 命名实体识别模型

## 项目概述

本项目实现了基于BiLSTM-CRF（双向长短时记忆网络与条件随机场）的命名实体识别（Named Entity Recognition, NER）模型。该模型旨在从非结构化文本中识别出具有特定意义的实体，如人名、地名、组织名等。BiLSTM用于捕捉文本的上下文信息，而CRF层则用于学习标签序列之间的依赖关系，从而输出全局最优的标签序列。

## 知识点总结

### 1. 命名实体识别 (Named Entity Recognition, NER)
- **目标**: 从文本中识别出具有特定意义的实体，并将其归类到预定义的类别中。
- **应用**: 信息抽取、问答系统、知识图谱构建等。
- **挑战**: 实体边界识别、实体类别歧义、嵌套实体等。

### 2. BiLSTM (Bidirectional Long Short-Term Memory)
- **原理**: LSTM是一种特殊的循环神经网络（RNN），能够有效处理序列数据中的长距离依赖问题。BiLSTM结合了前向LSTM和后向LSTM，可以同时捕捉序列的过去和未来的信息，从而获得更丰富的上下文表示。
- **在NER中的应用**: BiLSTM能够学习到每个词语在句子中的上下文表示，这些表示包含了词语作为实体一部分的丰富信息。

### 3. CRF (Conditional Random Field)
- **原理**: CRF是一种判别式概率图模型，常用于序列标注任务。它能够建模输出标签序列的全局依赖关系，而不仅仅是单个标签的局部信息。例如，CRF可以学习到“B-PER（人名开始）”后面不能直接跟着“I-LOC（地名中间）”这样的规则。
- **在NER中的应用**: CRF层接收BiLSTM输出的每个词语的标签分数，并结合标签之间的转移概率，计算出整个标签序列的联合概率，从而找到概率最大的合法标签序列。

### 4. 模型结构
- **Embedding Layer**: 将输入的词语转换为稠密的向量表示（词嵌入）。
- **BiLSTM Layer**: 处理词嵌入序列，生成上下文相关的隐藏状态。
- **CRF Layer**: 接收BiLSTM的输出，并计算标签序列的概率，进行解码以找到最优标签序列。

## 项目结果

该模型在命名实体识别任务上取得了良好的性能。以下是模型在验证集上的表现示例：

```
# 示例结果，具体数值会根据数据集和训练情况而异
Epoch: X, Loss: Y.YY, F1: Z.ZZ
              precision    recall  f1-score   support

    LOC       0.XX      0.YY      0.ZZ       NNN
    ORG       0.XX      0.YY      0.ZZ       MMM
    PER       0.XX      0.YY      0.ZZ       PPP

accuracy                           0.AA      Total
macro avg       0.BB      0.CC      0.DD      Total
weighted avg       0.EE      0.FF      0.GG      Total
```

**注意**: 具体的F1分数和各项指标会根据数据集、超参数和训练过程中的随机性有所波动。

## 逻辑流程

### 1. 数据准备
- 原始文本数据经过分词，并进行字级别或词级别的嵌入。
- 实体被标注为BIOES（Begin, Inside, Outside, End, Single）等序列标注格式。
- 数据集被划分为训练集、验证集和测试集。

### 2. 模型训练
1.  **初始化**: 加载词嵌入，初始化BiLSTM和CRF层。
2.  **前向传播**: 
    - 输入文本序列通过词嵌入层。
    - 词嵌入序列输入BiLSTM层，得到每个词语的上下文表示。
    - BiLSTM的输出作为CRF层的输入，CRF层计算所有可能标签路径的分数。
3.  **损失计算**: CRF层内部计算负对数似然损失，目标是最大化正确标签序列的概率。
4.  **反向传播与优化**: 根据损失计算梯度，并使用优化器（如Adam）更新模型参数。
5.  **验证与保存**: 在每个epoch结束后，模型在验证集上进行评估。如果性能（如F1分数）有所提升，则保存当前模型为最佳模型。

### 3. 模型评估
- 使用独立的测试集对训练好的模型进行最终评估，计算精确率（Precision）、召回率（Recall）和F1分数等指标。

### 4. 预测
- 加载训练好的模型。
- 对新的文本输入进行预处理，通过BiLSTM-CRF模型进行前向传播和维特比解码（Viterbi decoding），输出最优的标签序列。
- 根据标签序列，从文本中提取出命名实体。

