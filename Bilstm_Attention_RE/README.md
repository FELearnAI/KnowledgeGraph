# BiLSTM-Attention 关系抽取模型

## 项目概述

本项目实现了基于BiLSTM-Attention（双向长短时记忆网络与注意力机制）的关系抽取模型。该模型旨在从文本中识别出预定义实体对之间的语义关系。BiLSTM用于捕捉文本的上下文信息，而注意力机制则允许模型在判断关系时，更加关注文本中与关系相关的关键部分。

## 知识点总结

### 1. 关系抽取 (Relation Extraction, RE)
- **目标**: 识别文本中实体之间的语义关系，如“出生于”、“工作在”等。
- **挑战**: 文本中实体间关系的复杂性、长距离依赖、多关系共存等。

### 2. BiLSTM (Bidirectional Long Short-Term Memory)
- **原理**: LSTM是一种特殊的循环神经网络（RNN），能够有效处理序列数据中的长距离依赖问题。BiLSTM结合了前向LSTM和后向LSTM，可以同时捕捉序列的过去和未来的信息，从而获得更丰富的上下文表示。
- **优势**: 适用于序列标注、文本分类等任务，能够学习到词语在句子中的深层语义。

### 3. Attention Mechanism (注意力机制)
- **原理**: 允许模型在处理输入序列时，动态地分配不同的“注意力”权重给序列中的不同部分。在关系抽取中，这意味着模型可以更关注那些对判断实体关系至关重要的词语或短语。
- **优势**: 提高了模型对关键信息的捕捉能力，增强了模型的可解释性，有助于处理长文本中的关系抽取。

### 4. 模型结构
- **Embedding Layer**: 将输入的词语转换为稠密的向量表示（词嵌入）。
- **BiLSTM Layer**: 处理词嵌入序列，生成上下文相关的隐藏状态。
- **Attention Layer**: 根据BiLSTM的输出，计算每个词语的注意力权重，并生成加权后的上下文向量。
- **Output Layer**: 通常是一个全连接层，将注意力层的输出映射到关系分类的概率分布。

## 项目结果

该模型在关系抽取任务上取得了良好的性能。以下是模型在验证集上的表现示例：

```
Epoch 5, 验证集loss: 0.3982, 验证集F1: 0.8626
              precision    recall  f1-score   support

           0       0.86      0.96      0.91      1000
           1       0.91      0.85      0.88      1794
           2       0.63      0.71      0.67       594
           3       0.74      0.76      0.75       601
           4       0.96      0.90      0.93      1675

    accuracy                           0.86      5664
   macro avg       0.82      0.84      0.83      5664
weighted avg       0.87      0.86      0.86      5664

F1提升！已保存最佳模型！
训练结束，总耗时：333.67s
```

**注意**: 具体的F1分数和各项指标会根据数据集、超参数和训练过程中的随机性有所波动。

## 逻辑流程

### 1. 数据准备
- 原始文本数据经过分词、词嵌入处理。
- 实体对及其关系被标注，形成训练样本。
- 数据集被划分为训练集、验证集和测试集。

### 2. 模型训练
1.  **初始化**: 加载预训练的词嵌入（如果使用），初始化BiLSTM和注意力层。
2.  **前向传播**: 
    - 输入文本序列通过词嵌入层。
    - 词嵌入序列输入BiLSTM层，得到每个时间步的隐藏状态。
    - 注意力机制根据BiLSTM的隐藏状态计算权重，并生成一个加权的上下文向量。
    - 上下文向量通过全连接层进行关系分类。
3.  **损失计算**: 使用交叉熵损失函数计算预测关系与真实关系之间的差异。
4.  **反向传播与优化**: 根据损失计算梯度，并使用优化器（如Adam）更新模型参数。
5.  **验证与保存**: 在每个epoch结束后，模型在验证集上进行评估。如果性能（如F1分数）有所提升，则保存当前模型为最佳模型。

### 3. 模型评估
- 使用独立的测试集对训练好的模型进行最终评估，计算精确率（Precision）、召回率（Recall）和F1分数等指标。

### 4. 预测
- 加载训练好的模型。
- 对新的文本输入进行预处理，通过模型进行前向传播，得到实体对之间的关系预测。